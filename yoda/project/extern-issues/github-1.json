{
  "provider": "github",
  "number": "1",
  "title": "Issue para teste do YODA Intake",
  "description": "# yoda-0039 - Integrar backlog externo via glab e prever GitHub\n\n## Summary\nIntroduzir o comando `yoda_intake.py` como entrada operacional do YODA Intake. O comando deve orientar o agente por runbook e, quando houver issue externa, coletar dados via `glab`/`gh` com base no provedor detectado em `git remote origin`.\n\n## Context\nHoje o Intake esta descrito diretamente em `yoda/yoda.md`, sem um comando dedicado para guiar o agente e sem fluxo formal de ingestao de issue externa. Tambem faltam regras para descoberta de provedor, pre-condicoes de CLI/autenticacao e orientacao de fallback quando dependencias nao estao instaladas.\n\n## Objective\nPadronizar o Intake via `yoda_intake.py`, com fluxo em duas etapas (`--dev` inicial e chamadas subsequentes com/sem issue externa), mantendo rastreabilidade de origem externa e documentacao consistente em todo `project/specs/`.\n\n## Scope\n- Criar `yoda/scripts/yoda_intake.py`.\n- Suportar execucao inicial com `--dev` para devolver runbook curto de decisao.\n- Suportar execucao com `--dev --extern-issue <NNN>` para devolver:\n  - runbook completo do Intake para o agente;\n  - resumo amigavel (Markdown) da issue externa.\n- Suportar execucao com `--dev --no-extern-issue` para devolver runbook completo sem ingestao externa.\n- Detectar provedor pelo `origin` do repositorio (`.git/config` / remote URL) para decidir entre `glab` e `gh`.\n- Implementar cliente por provedor em modulos dedicados em `yoda/scripts/lib/` (ex.: `provider_gitlab.py`, `provider_github.py`).\n- Quando CLI necessario (`glab`/`gh`) nao estiver instalado, retornar instrucoes objetivas de instalacao ao humano.\n- Atualizar `yoda/yoda.md`: retirar detalhes operacionais de Intake e instruir que a entrada no Intake deve chamar `yoda_intake.py` e seguir o runbook.\n- Revisar e alinhar toda documentacao relevante em `project/specs/` para manter consistencia de contrato.\n- Manter classificacao da issue como **subtle**.\n\n## Out of scope\n- Sincronizacao bidirecional completa de estado entre plataformas.\n- Cobrir todos provedores de issue tracker alem de GitLab/GitHub.\n- Fechar automaticamente issues externas via texto de commit.\n\n## Requirements\n- Ordem obrigatoria: `project/specs/` antes de `yoda/`.\n- Ao entrar no YODA Intake, o agente deve chamar `yoda_intake.py --dev <slug>` como primeiro passo.\n- O retorno inicial (`--dev` apenas) deve orientar:\n  - perguntar ao humano se existe issue externa;\n  - se sim: executar `yoda_intake.py --dev <slug> --extern-issue <NNN>`;\n  - se nao: executar `yoda_intake.py --dev <slug> --no-extern-issue`.\n- Em modo `--extern-issue <NNN>`, o comando deve:\n  - detectar provedor pelo `origin`;\n  - consultar issue externa via CLI correspondente;\n  - retornar runbook completo + resumo Markdown da issue externa.\n- Se o provedor detectado nao estiver suportado, retornar erro explicito.\n- Se CLI necessario nao estiver instalado, retornar instrucao de instalacao para o humano.\n- Se autenticacao falhar/ausente, retornar erro explicito com proximo passo.\n- O YODA deve associar commit a issue externa usando `#NNN`, sem usar termos de fechamento automatico (`Closes/Fixes/Resolves`).\n- Deve existir rastreabilidade entre issue YODA criada e `origin` da issue externa.\n- Classificacao confirmada: **subtle**.\n\n## Acceptance criteria\n- [ ] `yoda_intake.py --dev <slug>` retorna runbook inicial com decisao externa vs sem externa.\n- [ ] `yoda_intake.py --dev <slug> --extern-issue <NNN>` retorna runbook completo e resumo Markdown da issue externa.\n- [ ] `yoda_intake.py --dev <slug> --no-extern-issue` retorna runbook completo sem consulta externa.\n- [ ] Provedor e CLI sao escolhidos pela origem (`origin`): GitLab -> `glab`, GitHub -> `gh`.\n- [ ] Sem CLI requerido instalado, o comando retorna instrucao de instalacao acionavel.\n- [ ] Sem suporte para o provedor detectado, o comando retorna erro explicito.\n- [ ] Fluxo documentado em `project/specs/` e `yoda/yoda.md` atualizado para delegar Intake ao script.\n- [ ] Regras de commit externo documentadas: associar com `#NNN`, sem fechamento automatico.\n- [ ] Fluxo suporta uma issue externa originando uma ou multiplas issues YODA com rastreabilidade.\n\n## Dependencies\n`yoda-0038` caso haja alteracao de layout YAML/origin.\n\n## Entry points\n- path: project/specs/\n  type: doc\n- path: yoda/scripts/yoda_intake.py\n  type: code\n- path: yoda/scripts/lib/provider_gitlab.py\n  type: code\n- path: yoda/scripts/lib/provider_github.py\n  type: code\n- path: yoda/yoda.md\n  type: doc\n- path: .git/config\n  type: config\n\n## Implementation notes\n- Decisao de planejamento: tratar esta issue como `subtle`.\n- Primeiro passo operacional do Intake passa a ser comando (`yoda_intake.py`) e nao bloco textual embutido no manual.\n- Provedor deve ser inferido da URL de `origin` (sem parametro adicional no MVP).\n- Nao fechar automaticamente issue externa; apenas associar por `#NNN` quando aplicavel no texto sugerido de commit.\n\n## Tests\n- Testes de CLI para tres modos: `--dev`, `--extern-issue`, `--no-extern-issue`.\n- Testes de deteccao de provedor a partir de `origin`.\n- Testes de erros acionaveis: CLI ausente, auth ausente, provedor nao suportado.\n- Testes de renderizacao do resumo Markdown da issue externa.\n- Testes de mapeamento de `origin` para uma e multiplas issues YODA.\n\n## Risks and edge cases\n- Limitacoes de autenticacao/escopo de token no `glab` e `gh`.\n- Diferencas de modelo de dados entre GitLab e GitHub.\n- Duplicacao de issues se nao houver controle de idempotencia na importacao.\n- Repositorios com multiplos remotes ou `origin` ausente.\n- Ambientes sem rede/CLI disponivel durante Intake.\n",
  "state": "open",
  "author": "alexdundes",
  "url": "https://github.com/alexdundes/yoda/issues/1",
  "labels": [
    "enhancement"
  ]
}
